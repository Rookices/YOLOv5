# 现有模型测试结果汇总

起因：各模型测试结果存在差异，因此基于原工程test.py脚本进行标准化，batch-size=32，conf-thres=0.5 iou-thres=0.5；模型命名规则为模型特征+img_size；

模型主要包括original、剪枝算法及通道减半；测试集为val、test3112及test99.

---

val

|  序号  |       模型       |              mAP50               |              mmAP               |              FLOPs              |             推理耗时             |             模型大小             |        备注         |
| :---: | :--------------: | :------------------------------: | :-----------------------------: | :-----------------------------: | :------------------------------: | :------------------------------: | :-----------------: |
|   1   |   original_640   |              0.991               |              0.915              |              18.6G              |              1.8ms               |              15.1M               | 旧数据集&通道数有误 |
|   2   | original_new_640 | <font color=red>**0.993**</font> | <font color=red>**0.94**</font> |              17.5G              |              1.9ms               |              14.3M               |      新数据集       |
|   3   |     0.5_640      |              0.986               |              0.909              |              4.4G               |              0.9ms               |               3.9M               |      通道减半       |
|   4   |    ft0.01_640    |               0.99               |              0.931              |              5.5G               |              1.1ms               |              2.48M               |      单次剪枝       |
|   5   |     nas_640      |              0.983               |              0.873              | <font color=red>**3.2G**</font> |              0.7ms               | <font color=red>**1.16M**</font> |     基于ft0.08      |
|   6   |    nas_final     |              0.985               |              0.905              |              3.6G               |              0.8ms               |              1.72M               |   基于4的迭代剪枝   |
|   7   |     0.5_320      |               0.99               |              0.923              |              4.4G               | <font color=red>**0.3ms**</font> |              3.72M               |                     |
| **8** | ⭐**0.5_640_new** | <font color=blue>**0.997**</font> | 0.875 | / | / | / | **经筛选后数据集**  |

![original_val](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-original_val.png) 

![original_new_val](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-original_new_val.png) original新数据集

![0.5_640_val](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-0.5_640_val.png) 通道减半

![ft_0.01_val](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-ft_0.01_val.png) one-shot剪枝

![nas_640_val](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-nas_640_val.png) 

![nas_final](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E8%BF%AD%E4%BB%A3%E5%89%AA%E6%9E%9D%E7%AE%80%E6%8A%A5-IMP0.01_nas_final_val_map.png) 最终迭代剪枝

![0.5_320_val](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-0.5_320_val.png) 

![0.5_640_new_val](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-0.5_640_new_val.png) ⭐0.5_640_new

---

test3112

| 序号  |       模型       |                 P                 |                 R                 |               mAP50               |               mmAP                |    备注    |
| :---: | :--------------: | :-------------------------------: | :-------------------------------: | :-------------------------------: | :-------------------------------: | :--------: |
|   1   |   original_640   | <font color=red>**0.978**</font>  |               0.952               |               0.961               |               0.841               |            |
|   2   | original_new_640 |               0.972               |               0.962               | <font color=red>**0.967**</font>  | <font color=red>**0.844**</font>  |            |
|   3   |     0.5_640      |               0.967               |               0.957               |               0.95                |               0.828               |  通道减半  |
|   4   |    ft0.01_640    |               0.967               | <font color=red>**0.968**</font>  |               0.963               |               0.835               |            |
|   5   |     nas_640      |               0.959               |               0.953               |               0.942               |               0.79                |            |
|   6   |    nas_final     |               0.969               |               0.956               |               0.944               |               0.830               |  迭代剪枝  |
|   7   |     0.5_320      |               0.972               |               0.96                |               0.961               |               0.823               |            |
| **8** | ⭐**0.5_640_new** | <font color=blue>**0.995**</font> | <font color=blue>**0.995**</font> | <font color=blue>**0.998**</font> | <font color=blue>**0.867**</font> | 样本数2802 |
|  8*   |     0.5_640      |               0.992               |               0.988               |               0.991               |               0.867               | 样本数2802 |

![original_test3112](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-original_test3112.png) 

![original_new_test3112](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-original_new_test3112.png) original新数据集

![0.5_640_test3112](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-0.5_640_test3112.png) 通道减半

![ft_0.01_test3112](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-ft_0.01_test3112.png) 

![nas_640_test3112](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-nas_640_test3112.png) 

![nas_final](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E8%BF%AD%E4%BB%A3%E5%89%AA%E6%9E%9D%E7%AE%80%E6%8A%A5-IMP0.01_nas_final_test3112_map.png) 最终迭代剪枝

![0.5_320_test3112](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-0.5_320_test3112.png) 

![0.5_640_new_test2802](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-0.5_640_newl_test2802.png) ⭐0.5_640_new

![0.5_640_test2802](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-0.5_640_test2802.png) 0.5_640用于与上图对比

---

test99

| 序号 |       模型       |                P                 |                R                 |              mAP50               |               mmAP               |   备注   |
| :--: | :--------------: | :------------------------------: | :------------------------------: | :------------------------------: | :------------------------------: | :------: |
|  1   |   original_640   |              0.955               | <font color=red>**0.984**</font> | <font color=red>**0.987**</font> |              0.711               |          |
|  2   | original_new_640 |              0.958               |               0.97               |              0.972               |              0.726               |          |
|  3   |     0.5_640      |              0.973               |               0.97               |              0.979               | <font color=red>**0.749**</font> | 通道减半 |
|  4   |    ft0.01_640    |              0.971               |              0.968               |              0.983               |              0.737               |          |
|  5   |     nas_640      |              0.952               |              0.961               |              0.972               |               0.74               |          |
|  6   |    nas-final     | <font color=red>**0.995**</font> |              0.964               |              0.975               |              0.738               | 迭代剪枝 |
|  7   |     0.5_320      |              0.979               |              0.955               |              0.958               |              0.713               |          |

| 人工统计⭐0.5_640_new |  dmcode  | qrcode  |  barcode  |   sum   |
| :------------------: | :------: | :-----: | :-------: | :-----: |
|      **样本数**      |  **48**  | **75**  |  **162**  |         |
|  正确识别数/精确率P  | 47/97.9% | 75/100% | 157/96.9% | P=0.979 |
|       漏检个数       |    1     |    0    |     5     |         |
|  误检个数/误检率1-R  |  5/9.6%  | 2/2.6%  |     0     | R=0.972 |

![original_test99](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-original_test99.png) 

![original_new_test99](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-original_new_test99.png) original新数据集

![0.5_640_test99](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-0.5_640_test99.png) 通道减半

![ft0.01_test99](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-ft0.01_test99.png) 

![nas_640_test99](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-nas_640_test99.png) 

![nas_final](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E8%BF%AD%E4%BB%A3%E5%89%AA%E6%9E%9D%E7%AE%80%E6%8A%A5-IMP0.01_nas_final_test99_map.png) 最终迭代剪枝

![0.5_320_test99](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-0.5_320_test99.png) 

---

### 关于0.5_640_new测试补充

测试集为由原数据集剔除的样本组成，共2307张，iou及置信度阈值均为0.5

#### 错检&漏检

##### DM残缺码误检

![DM残缺码误检](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-DM%E6%AE%8B%E7%BC%BA%E7%A0%81%E8%AF%AF%E6%A3%80.jpg)

##### 条形码识别异常，单检测框中有多个条形码

![条形码识别异常](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-%E6%9D%A1%E5%BD%A2%E7%A0%81%E8%AF%86%E5%88%AB%E5%BC%82%E5%B8%B8%E2%80%98.jpg)

##### 条形码漏检，可能原因是此时条码为小目标而且较为密集

![条形码漏检](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-%E6%9D%A1%E5%BD%A2%E7%A0%81%E6%BC%8F%E6%A3%80.jpg)

---

#### 识别成功

##### DM难样本识别成功

![DM难样本识别成功](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-DM%E9%9A%BE%E6%A0%B7%E6%9C%AC%E8%AF%86%E5%88%AB%E6%88%90%E5%8A%9F.jpg)

##### 条形码得分对比. 残缺码<完整<完整+带数字

![条形码得分对比](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-%E6%9D%A1%E5%BD%A2%E7%A0%81%E5%BE%97%E5%88%86%E5%AF%B9%E6%AF%94.jpg)

##### 异形条形码识别.

![异形条形码成功识别](https://whiskey-tuku.oss-cn-beijing.aliyuncs.com/img/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3&%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/%E5%89%AA%E6%9E%9D%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB%E5%8F%8A%E5%AF%B9%E6%AF%94-%E5%BC%82%E5%BD%A2%E6%9D%A1%E5%BD%A2%E7%A0%81%E6%88%90%E5%8A%9F%E8%AF%86%E5%88%AB.jpg)

**总体上，模型能较好学习到条码外形特征，但残缺码误识率较高。**

---

综上，

1. 对比模型1与模型2，新增数据集能提升精度；
2. 模型3(通道减半)能较好地保留原有original精度;
3. 模型4(单次剪枝的ft0.01)精度胜过origina，但是推理耗时略高于通道减；
4. 模型5(nas)表现并不如意，原因为ft0.08精度损失较大，后续应对ft0.01进行迭代剪枝再nas。



